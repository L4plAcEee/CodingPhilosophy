---
笔记: 2025-06-24
摘要: 
tags:
  - 题解
---
## [P1605 迷宫](https://www.luogu.com.cn/problem/P1605)
### 思路
感觉可以DP，但是先想简单的吧
DFS？ DFS可以。

**可以DP，但是得用状压DP。**
- 这是一个「无环路径计数」问题，但路径必须**不能重复访问节点**；
	
- 状态除了当前位置（x,y），还需记录哪些格子已经访问过，这样才能避免重复；
	
- 这意味着状态包含：当前位置 + 访问过的格子集合。

**不可以BFS**
BFS 是逐层扩展状态，常用于**找最短路径**或者**是否可达**，但在这道题中：
- **必须记录“路径上哪些格子已经访问过”**，以防止重复访问；
    
- 这意味着每个 BFS 状态需要保存当前位置和访问状态（通常用位掩码）；
    
- 状态数极多，达到 `位置数 × 2^(位置数)`，即最多 `25 × 2^25 ≈ 8 亿` 级别，非常庞大。

### 解
```cpp
int grids[6][6] = {0};
int N, M, T, SX, SY, FX, FY;
int ans = 0;
void dfs(int x, int y) {
    if (x < 1 || x > N || y < 1 || y > M || grids[x][y] != 0) {
        return;
    }
    if (x == FX && y == FY) {
        ans++;
        return;
    }
    grids[x][y] = 1;
    dfs(x + 1, y);
    dfs(x, y + 1);
    dfs(x - 1, y);
    dfs(x, y - 1);
    grids[x][y] = 0;
}

int main() {
    cin >> N >> M >> T;
    cin >> SX >> SY >> FX >> FY;
    int BX, BY;
    while (T--) {
        cin >> BX >> BY;
        grids[BX][BY] = -1;
    }
    dfs(SX, SY);
    cout << ans << '\n';
}
```